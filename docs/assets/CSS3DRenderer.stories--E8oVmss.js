import{r as _}from"./index-RYns6xqu.js";import{V as p,O as st,Q as J,M as tt,C as it,c as x,d as E,e as W,S as ot,P as nt,f as rt}from"./three.module-DJIKMl97.js";const X=new p,ht=new J,V=new p;class at extends st{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(i){i.element instanceof Element&&i.element.parentNode!==null&&i.element.parentNode.removeChild(i.element)})})}copy(e,i){return super.copy(e,i),this.element=e.element.cloneNode(!0),this}}const f=new tt,ct=new tt;class lt{constructor(e={}){const i=this;let c,d,a,M;const w={camera:{style:""},objects:new WeakMap},l=e.element!==void 0?e.element:document.createElement("div");l.style.overflow="hidden",this.domElement=l;const h=document.createElement("div");h.style.transformOrigin="0 0",h.style.pointerEvents="none",l.appendChild(h);const m=document.createElement("div");m.style.transformStyle="preserve-3d",h.appendChild(m),this.getSize=function(){return{width:c,height:d}},this.render=function(o,t){const u=t.projectionMatrix.elements[5]*M;t.view&&t.view.enabled?(h.style.transform=`translate( ${-t.view.offsetX*(c/t.view.width)}px, ${-t.view.offsetY*(d/t.view.height)}px )`,h.style.transform+=`scale( ${t.view.fullWidth/t.view.width}, ${t.view.fullHeight/t.view.height} )`):h.style.transform="",o.matrixWorldAutoUpdate===!0&&o.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld();let N,y;t.isOrthographicCamera&&(N=-(t.right+t.left)/2,y=(t.top+t.bottom)/2);const g=t.view&&t.view.enabled?t.view.height/t.view.fullHeight:1,v=t.isOrthographicCamera?`scale( ${g} )scale(`+u+")translate("+n(N)+"px,"+n(y)+"px)"+S(t.matrixWorldInverse):`scale( ${g} )translateZ(`+u+"px)"+S(t.matrixWorldInverse),D=(t.isPerspectiveCamera?"perspective("+u+"px) ":"")+v+"translate("+a+"px,"+M+"px)";w.camera.style!==D&&(m.style.transform=D,w.camera.style=D),C(o,o,t)},this.setSize=function(o,t){c=o,d=t,a=c/2,M=d/2,l.style.width=o+"px",l.style.height=t+"px",h.style.width=o+"px",h.style.height=t+"px",m.style.width=o+"px",m.style.height=t+"px"};function n(o){return Math.abs(o)<1e-10?0:o}function S(o){const t=o.elements;return"matrix3d("+n(t[0])+","+n(-t[1])+","+n(t[2])+","+n(t[3])+","+n(t[4])+","+n(-t[5])+","+n(t[6])+","+n(t[7])+","+n(t[8])+","+n(-t[9])+","+n(t[10])+","+n(t[11])+","+n(t[12])+","+n(-t[13])+","+n(t[14])+","+n(t[15])+")"}function j(o){const t=o.elements;return"translate(-50%,-50%)"+("matrix3d("+n(t[0])+","+n(t[1])+","+n(t[2])+","+n(t[3])+","+n(-t[4])+","+n(-t[5])+","+n(-t[6])+","+n(-t[7])+","+n(t[8])+","+n(t[9])+","+n(t[10])+","+n(t[11])+","+n(t[12])+","+n(t[13])+","+n(t[14])+","+n(t[15])+")")}function P(o){o.isCSS3DObject&&(o.element.style.display="none");for(let t=0,u=o.children.length;t<u;t++)P(o.children[t])}function C(o,t,u,N){if(o.visible===!1){P(o);return}if(o.isCSS3DObject){const y=o.layers.test(u.layers)===!0,g=o.element;if(g.style.display=y===!0?"":"none",y===!0){o.onBeforeRender(i,t,u);let v;o.isCSS3DSprite?(f.copy(u.matrixWorldInverse),f.transpose(),o.rotation2D!==0&&f.multiply(ct.makeRotationZ(o.rotation2D)),o.matrixWorld.decompose(X,ht,V),f.setPosition(X),f.scale(V),f.elements[3]=0,f.elements[7]=0,f.elements[11]=0,f.elements[15]=1,v=j(f)):v=j(o.matrixWorld);const Z=w.objects.get(o);if(Z===void 0||Z.style!==v){g.style.transform=v;const D={style:v};w.objects.set(o,D)}g.parentNode!==m&&m.appendChild(g),o.onAfterRender(i,t,u)}}for(let y=0,g=o.children.length;y<g;y++)C(o.children[y],t,u)}}}const L={type:"change"},Y={type:"start"},H={type:"end"},q=1e-6,r={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},T=new E,b=new E,pt=new p,z=new p,U=new p,O=new J,K=new p,k=new p,I=new p,R=new p;class dt extends it{constructor(e,i=null){super(e,i),this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:x.ROTATE,MIDDLE:x.DOLLY,RIGHT:x.PAN},this.state=r.NONE,this.keyState=r.NONE,this.target=new p,this._lastPosition=new p,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new p,this._movePrev=new E,this._moveCurr=new E,this._lastAxis=new p,this._zoomStart=new E,this._zoomEnd=new E,this._panStart=new E,this._panEnd=new E,this._pointers=[],this._pointerPositions={},this._onPointerMove=ut.bind(this),this._onPointerDown=mt.bind(this),this._onPointerUp=_t.bind(this),this._onPointerCancel=ft.bind(this),this._onContextMenu=vt.bind(this),this._onMouseWheel=bt.bind(this),this._onKeyDown=gt.bind(this),this._onKeyUp=yt.bind(this),this._onTouchStart=Ct.bind(this),this._onTouchMove=Ot.bind(this),this._onTouchEnd=xt.bind(this),this._onMouseDown=Et.bind(this),this._onMouseMove=wt.bind(this),this._onMouseUp=St.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,i!==null&&(this.connect(),this.handleResize()),this.update()}connect(){window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),i=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-i.clientLeft,this.screen.top=e.top+window.pageYOffset-i.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>q&&(this.dispatchEvent(L),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>q||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(L),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=r.NONE,this.keyState=r.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(L),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(b.copy(this._panEnd).sub(this._panStart),b.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,i=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;b.x*=e,b.y*=i}b.multiplyScalar(this._eye.length()*this.panSpeed),z.copy(this._eye).cross(this.object.up).setLength(b.x),z.add(pt.copy(this.object.up).setLength(b.y)),this.object.position.add(z),this.target.add(z),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(b.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){R.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=R.length();e?(this._eye.copy(this.object.position).sub(this.target),K.copy(this._eye).normalize(),k.copy(this.object.up).normalize(),I.crossVectors(k,K).normalize(),k.setLength(this._moveCurr.y-this._movePrev.y),I.setLength(this._moveCurr.x-this._movePrev.x),R.copy(k.add(I)),U.crossVectors(R,this._eye).normalize(),e*=this.rotateSpeed,O.setFromAxisAngle(U,e),this._eye.applyQuaternion(O),this.object.up.applyQuaternion(O),this._lastAxis.copy(U),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),O.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(O),this.object.up.applyQuaternion(O)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===r.TOUCH_ZOOM_PAN?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=W.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,e!==1&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=W.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,i){return T.set((e-this.screen.left)/this.screen.width,(i-this.screen.top)/this.screen.height),T}_getMouseOnCircle(e,i){return T.set((e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-i))/this.screen.width),T}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let i=0;i<this._pointers.length;i++)if(this._pointers[i].pointerId==e.pointerId){this._pointers.splice(i,1);return}}_trackPointer(e){let i=this._pointerPositions[e.pointerId];i===void 0&&(i=new E,this._pointerPositions[e.pointerId]=i),i.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const i=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[i.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function mt(s){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(s.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(s),s.pointerType==="touch"?this._onTouchStart(s):this._onMouseDown(s))}function ut(s){this.enabled!==!1&&(s.pointerType==="touch"?this._onTouchMove(s):this._onMouseMove(s))}function _t(s){this.enabled!==!1&&(s.pointerType==="touch"?this._onTouchEnd(s):this._onMouseUp(),this._removePointer(s),this._pointers.length===0&&(this.domElement.releasePointerCapture(s.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function ft(s){this._removePointer(s)}function yt(){this.enabled!==!1&&(this.keyState=r.NONE,window.addEventListener("keydown",this._onKeyDown))}function gt(s){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===r.NONE&&(s.code===this.keys[r.ROTATE]&&!this.noRotate?this.keyState=r.ROTATE:s.code===this.keys[r.ZOOM]&&!this.noZoom?this.keyState=r.ZOOM:s.code===this.keys[r.PAN]&&!this.noPan&&(this.keyState=r.PAN)))}function Et(s){let e;switch(s.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case x.DOLLY:this.state=r.ZOOM;break;case x.ROTATE:this.state=r.ROTATE;break;case x.PAN:this.state=r.PAN;break;default:this.state=r.NONE}const i=this.keyState!==r.NONE?this.keyState:this.state;i===r.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(s.pageX,s.pageY)),this._movePrev.copy(this._moveCurr)):i===r.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(s.pageX,s.pageY)),this._zoomEnd.copy(this._zoomStart)):i===r.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(s.pageX,s.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(Y)}function wt(s){const e=this.keyState!==r.NONE?this.keyState:this.state;e===r.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(s.pageX,s.pageY))):e===r.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(s.pageX,s.pageY)):e===r.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(s.pageX,s.pageY))}function St(){this.state=r.NONE,this.dispatchEvent(H)}function bt(s){if(this.enabled!==!1&&this.noZoom!==!0){switch(s.preventDefault(),s.deltaMode){case 2:this._zoomStart.y-=s.deltaY*.025;break;case 1:this._zoomStart.y-=s.deltaY*.01;break;default:this._zoomStart.y-=s.deltaY*25e-5;break}this.dispatchEvent(Y),this.dispatchEvent(H)}}function vt(s){this.enabled!==!1&&s.preventDefault()}function Ct(s){switch(this._trackPointer(s),this._pointers.length){case 1:this.state=r.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this.state=r.TOUCH_ZOOM_PAN;const e=this._pointers[0].pageX-this._pointers[1].pageX,i=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+i*i);const c=(this._pointers[0].pageX+this._pointers[1].pageX)/2,d=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(c,d)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(Y)}function Ot(s){switch(this._trackPointer(s),this._pointers.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(s.pageX,s.pageY));break;default:const e=this._getSecondPointerPosition(s),i=s.pageX-e.x,c=s.pageY-e.y;this._touchZoomDistanceEnd=Math.sqrt(i*i+c*c);const d=(s.pageX+e.x)/2,a=(s.pageY+e.y)/2;this._panEnd.copy(this._getMouseOnScreen(d,a));break}}function xt(s){switch(this._pointers.length){case 0:this.state=r.NONE;break;case 1:this.state=r.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(s.pageX,s.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=r.TOUCH_ZOOM_PAN;for(let e=0;e<this._pointers.length;e++)if(this._pointers[e].pointerId!==s.pointerId){const i=this._pointerPositions[this._pointers[e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(i.x,i.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(H)}const F=200,B=540;function et(){const s=_.useRef(null),e=_.useRef(!1),i=_.useRef(!1),c=_.useRef(),d=_.useRef(),[a,M]=_.useState({width:F,height:B});_.useEffect(()=>{if(!s.current)return;const l=F,h=B,m=new ot,n=new nt(45,l/h,.1,1e3);n.position.set(200,200,200),c.current=n;const S=new lt;d.current=S,S.setSize(l,h),s.current.appendChild(S.domElement);const j=new dt(n,S.domElement);for(let C=0;C<10;C++){const o=document.createElement("div");o.style.width="60px",o.style.height="60px",o.style.opacity=C<5?"0.5":"1",o.style.background=new rt(Math.random()*16777215).getStyle();const t=new at(o);t.position.x=Math.random()*200-100,t.position.y=Math.random()*200-100,t.position.z=Math.random()*200-100,t.rotation.x=Math.random(),t.rotation.y=Math.random(),t.rotation.z=Math.random(),t.scale.x=Math.random()+.5,t.scale.y=Math.random()+.5,m.add(t)}const P=()=>{j.update(),S.render(m,n),e.current&&requestAnimationFrame(P)};return e.current=!0,P(),()=>{e.current=!1}},[]),_.useEffect(()=>{!c.current||!d.current||(d.current.setSize(a.width,a.height),c.current.aspect=a.width/a.height)},[a.height,a.width]);const w=_.useRef(new ResizeObserver(l=>{const h=l[0],m=h.contentRect.width,n=i.current?a.height:h.contentRect.height;s.current&&w.current&&M({width:m,height:n})}));return _.useEffect(()=>{if(!s.current||!w.current)return;const l=document.querySelector("#root");l&&l.getAttribute("hidden")==="true"&&(i.current=!0);const h=s.current.parentElement;h&&w.current.observe(h)},[]),_.createElement("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},_.createElement("div",{ref:s,style:{width:a.width,height:a.height}}))}et.__docgenInfo={description:`Three.js 的坐标建模体系也适用于 CSS3 \`transform()\`，如果你的交互采用 DOM 实现，但又想复用 Three.js 中的相机来决定位置，
[CSS3DRenderer](https://threejs.org/examples/?q=css3d#css3d_sandbox) 是个很合适的解决方案。

\`\`\`jsx
import { CSS3DObject, CSS3DRenderer } from 'three/examples/jsm/renderers/CSS3DRenderer'

// 场景
const css3DScene = new THREE.Scene()
// 相机
const camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000)
camera.position.set(200, 200, 200)
// 渲染器
const renderer = new CSS3DRenderer()
renderer.setSize(width, height)
// 塞入 DOM
container.appendChild(renderer.domElement)

// 物品
const object = new CSS3DObject(element)
css3DScene.add(object)

// 渲染
renderer.render(css3DScene, camera)
\`\`\`

**CSS3 \`transform()\` 强大到可爱**。`,methods:[],displayName:"CSS3DRendererView"};const Dt={title:"three/CSS3DRenderer",component:et,args:{}},A={args:{}};var $,Q,G;A.parameters={...A.parameters,docs:{...($=A.parameters)==null?void 0:$.docs,source:{originalSource:`{
  args: {}
}`,...(G=(Q=A.parameters)==null?void 0:Q.docs)==null?void 0:G.source}}};const jt=["Primary"];export{A as Primary,jt as __namedExportsOrder,Dt as default};
